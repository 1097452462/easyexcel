<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-quickstart/write">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Easy Excel RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Easy Excel Atom Feed"><title data-rh="true">写Excel | Easy Excel</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="写Excel | Easy Excel"><meta data-rh="true" name="description" content="通用数据生成 后面不会重复写"><meta data-rh="true" property="og:description" content="通用数据生成 后面不会重复写"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write" hreflang="zh"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/en/docs/3.x/quickstart/write" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.553adfbb.css">
<link rel="preload" href="/assets/js/runtime~main.9214ad1a.js" as="script">
<link rel="preload" href="/assets/js/main.834bc3ec.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Easy Excel" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="Easy Excel" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Easy Excel</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/docs/3.x/">文档</a><a class="navbar__item navbar__link" href="/qa/">常见问题</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/3.x/">3.x</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/3.x/quickstart/write">3.x</a></li><li><a class="dropdown__link" href="/docs/2.x/quickstart/write">2.x</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>中文</span></span></a><ul class="dropdown__menu"><li><a href="/docs/3.x/quickstart/write" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">中文</a></li><li><a href="/en/docs/3.x/quickstart/write" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li></ul></div><a href="https://github.com/alibaba/easyexcel" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3.x/">关于EasyExcel</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/3.x/quickstart/read">快速开始</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3.x/quickstart/read">读Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/3.x/quickstart/write">写Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3.x/quickstart/fil">填充Excel</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">快速开始</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">写Excel</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：3.x</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>写Excel</h1></header><h5 class="anchor anchorWithStickyNavbar_mojV" id="通用数据生成-后面不会重复写">通用数据生成 后面不会重复写<a class="hash-link" href="#通用数据生成-后面不会重复写" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;DemoData&gt; data() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;DemoData&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            DemoData data = new DemoData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setString(&quot;字符串&quot; + i);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDate(new Date());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDoubleData(0.56);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="示例代码">示例代码<a class="hash-link" href="#示例代码" title="标题的直接链接">​</a></h2><p>DEMO代码地址：<a href="https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="最简单的写">最简单的写<a class="hash-link" href="#最简单的写" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例">excel示例<a class="hash-link" href="#excel示例" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584453970149-7ed15d67-b66f-4087-9b77-d79049121792.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=f024X&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象">对象<a class="hash-link" href="#对象" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;字符串标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 忽略这个字段</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelIgnore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String ignore;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码">代码<a class="hash-link" href="#代码" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 最简单的写</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void simpleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 注意 simpleWrite在数据量不大的情况下可以使用（5000以内，具体也要看实际情况），数据量大参照 重复多次写入</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 写法1 JDK8+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // since: 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;simpleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 如果这里想使用03 则 传入excelType参数即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(() -&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // 分页查询数据</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 写法2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;simpleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 如果这里想使用03 则 传入excelType参数即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 写法3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;simpleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ExcelWriter excelWriter = null;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteSheet writeSheet = EasyExcel.writerSheet(&quot;模板&quot;).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter.write(data(), writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 千万别忘记finish 会帮忙关闭流</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="根据参数只导出指定列">根据参数只导出指定列<a class="hash-link" href="#根据参数只导出指定列" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-1">excel示例<a class="hash-link" href="#excel示例-1" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584453996937-4c24b29d-3f50-47b3-927e-4fbcb01b3adb.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=ZXzdN&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-1">对象<a class="hash-link" href="#对象-1" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-1">代码<a class="hash-link" href="#代码-1" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 根据参数只导出指定列</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 根据自己或者排除自己需要的列</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void excludeOrIncludeWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;excludeOrIncludeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里需要注意 在使用ExcelProperty注解的使用，如果想不空列则需要加入order字段，而不是index,order会忽略空列，然后继续往后，而index，不会忽略空列，在第几列就是第几列。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 根据用户传入字段 假设我们要忽略 date</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Set&lt;String&gt; excludeColumnFiledNames = new HashSet&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        excludeColumnFiledNames.add(&quot;date&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).excludeColumnFiledNames(excludeColumnFiledNames).sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;excludeOrIncludeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 根据用户传入字段 假设我们只要导出 date</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Set&lt;String&gt; includeColumnFiledNames = new HashSet&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        includeColumnFiledNames.add(&quot;date&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).includeColumnFiledNames(includeColumnFiledNames).sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="指定写入的列">指定写入的列<a class="hash-link" href="#指定写入的列" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-2">excel示例<a class="hash-link" href="#excel示例-2" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454018383-00194644-06a8-4e89-9d2f-99005652d4d4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=289&amp;id=bsNnj&amp;originHeight=289&amp;originWidth=536&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=536" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-2">对象<a class="hash-link" href="#对象-2" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class IndexData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;字符串标题&quot;, index = 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;日期标题&quot;, index = 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 这里设置3 会导致第二列空的</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;数字标题&quot;, index = 3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-2">代码<a class="hash-link" href="#代码-2" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 指定写入的列</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link IndexData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. 使用{@link ExcelProperty}注解指定写入的列</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void indexWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;indexWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, IndexData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="复杂头写入">复杂头写入<a class="hash-link" href="#复杂头写入" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-3">excel示例<a class="hash-link" href="#excel示例-3" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454030244-62eccf86-d33b-4dac-93ec-397821957565.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=296&amp;id=kIN7D&amp;originHeight=296&amp;originWidth=298&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=298" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-3">对象<a class="hash-link" href="#对象-3" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ComplexHeadData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty({&quot;主标题&quot;, &quot;字符串标题&quot;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty({&quot;主标题&quot;, &quot;日期标题&quot;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty({&quot;主标题&quot;, &quot;数字标题&quot;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-3">代码<a class="hash-link" href="#代码-3" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 复杂头写入</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link ComplexHeadData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. 使用{@link ExcelProperty}注解指定复杂的头</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void complexHeadWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;complexHeadWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, ComplexHeadData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="重复多次写入写到单个或者多个sheet">重复多次写入(写到单个或者多个Sheet)<a class="hash-link" href="#重复多次写入写到单个或者多个sheet" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-4">excel示例<a class="hash-link" href="#excel示例-4" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454058148-664960ac-69bf-4db0-92a1-4904c0f4130b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=468&amp;id=eiNc4&amp;originHeight=468&amp;originWidth=283&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=283" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-4">对象<a class="hash-link" href="#对象-4" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-4">代码<a class="hash-link" href="#代码-4" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 重复多次写入</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link ComplexHeadData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 使用{@link ExcelProperty}注解指定复杂的头</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. 直接调用二次写入即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void repeatedWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法1 如果写到同一个sheet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;repeatedWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ExcelWriter excelWriter = null;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里 需要指定写用哪个class去写</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里注意 如果同一个sheet只要创建一次</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteSheet writeSheet = EasyExcel.writerSheet(&quot;模板&quot;).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for (int i = 0; i &lt; 5; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                List&lt;DemoData&gt; data = data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.write(data, writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 千万别忘记finish 会帮忙关闭流</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法2 如果写到不同的sheet 同一个对象</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;repeatedWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里 指定文件</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来。这里最终会写到5个sheet里面</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for (int i = 0; i &lt; 5; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // 每次都要创建writeSheet 这里注意必须指定sheetNo 而且sheetName必须不一样</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                WriteSheet writeSheet = EasyExcel.writerSheet(i, &quot;模板&quot; + i).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                List&lt;DemoData&gt; data = data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.write(data, writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 千万别忘记finish 会帮忙关闭流</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法3 如果写到不同的sheet 不同的对象</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;repeatedWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里 指定文件</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来。这里最终会写到5个sheet里面</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for (int i = 0; i &lt; 5; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // 每次都要创建writeSheet 这里注意必须指定sheetNo 而且sheetName必须不一样。这里注意DemoData.class 可以每次都变，我这里为了方便 所以用的同一个class 实际上可以一直变</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                WriteSheet writeSheet = EasyExcel.writerSheet(i, &quot;模板&quot; + i).head(DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                List&lt;DemoData&gt; data = data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.write(data, writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 千万别忘记finish 会帮忙关闭流</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="日期数字或者自定义格式转换">日期、数字或者自定义格式转换<a class="hash-link" href="#日期数字或者自定义格式转换" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-5">excel示例<a class="hash-link" href="#excel示例-5" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454076557-cabbe44e-5801-44f8-b689-385ec4ceb18d.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=313&amp;id=VIaYK&amp;originHeight=313&amp;originWidth=512&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=512" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-5">对象<a class="hash-link" href="#对象-5" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ConverterData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想所有的 字符串起前面加上&quot;自定义：&quot;三个字</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;字符串标题&quot;, converter = CustomStringStringConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想写到excel 用年月日的格式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @DateTimeFormat(&quot;yyyy年MM月dd日HH时mm分ss秒&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想写到excel 用百分比表示</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @NumberFormat(&quot;#.##%&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-5">代码<a class="hash-link" href="#代码-5" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 日期、数字或者自定义格式转换</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link ConverterData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. 使用{@link ExcelProperty}配合使用注解{@link DateTimeFormat}、{@link NumberFormat}或者自定义注解</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void converterWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;converterWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, ConverterData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="图片导出">图片导出<a class="hash-link" href="#图片导出" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-6">excel示例<a class="hash-link" href="#excel示例-6" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2021/png/553000/1631889109313-0df2831a-06e8-42bb-8eed-94bf4eb154bb.png#clientId=u161a1dee-6811-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=380&amp;id=u7d4f6af1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=380&amp;originWidth=1044&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=168990&amp;status=done&amp;style=none&amp;taskId=u9de24145-4863-481a-af3e-0bdfe20363d&amp;title=&amp;width=1044" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-6">对象<a class="hash-link" href="#对象-6" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentRowHeight(100)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ColumnWidth(100 / 8)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ImageDemoData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private File file;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private InputStream inputStream;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 如果string类型 必须指定转换器，string默认转换成string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(converter = StringImageConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private byte[] byteArray;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 根据url导出</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private URL url;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 根据文件导出 并设置导出的位置。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;Void&gt; writeCellDataFile;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-6">代码<a class="hash-link" href="#代码-6" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 图片导出</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link ImageDemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void imageWrite() throws Exception {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;imageWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String imagePath = TestFileUtil.getPath() + &quot;converter&quot; + File.separator + &quot;img.jpg&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try (InputStream inputStream = FileUtils.openInputStream(new File(imagePath))) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            List&lt;ImageDemoData&gt; list =  ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ImageDemoData imageDemoData = new ImageDemoData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(imageDemoData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 放入五种类型的图片 实际使用只要选一种即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setByteArray(FileUtils.readFileToByteArray(new File(imagePath)));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setFile(new File(imagePath));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setString(imagePath);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setInputStream(inputStream);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setUrl(new URL(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;https://raw.githubusercontent.com/alibaba/easyexcel/master/src/test/resources/converter/img.jpg&quot;));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里演示</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 需要额外放入文字</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 而且需要放入2个图片</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 第一个图片靠左</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 第二个靠右 而且要额外的占用他后面的单元格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteCellData&lt;Void&gt; writeCellData = new WriteCellData&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setWriteCellDataFile(writeCellData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里可以设置为 EMPTY 则代表不需要其他数据了</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setType(CellDataTypeEnum.STRING);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setStringValue(&quot;额外的放一些文字&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 可以放入多个图片</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            List&lt;ImageData&gt; imageDataList = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ImageData imageData = new ImageData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDataList.add(imageData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setImageDataList(imageDataList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 放入2进制图片</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImage(FileUtils.readFileToByteArray(new File(imagePath)));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 图片类型</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImageType(ImageType.PICTURE_TYPE_PNG);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 上 右 下 左 需要留空</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这个类似于 css 的 margin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里实测 不能设置太大 超过单元格原始大小后 打开会提示修复。暂时未找到很好的解法。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setTop(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRight(40);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setBottom(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setLeft(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 放入第二个图片</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData = new ImageData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDataList.add(imageData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setImageDataList(imageDataList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImage(FileUtils.readFileToByteArray(new File(imagePath)));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImageType(ImageType.PICTURE_TYPE_PNG);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setTop(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRight(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setBottom(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setLeft(50);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 设置图片的位置 假设 现在目标 是 覆盖 当前单元格 和当前单元格右边的单元格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 起点相对于当前单元格为0 当然可以不写</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeFirstRowIndex(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeFirstColumnIndex(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeLastRowIndex(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 前面3个可以不写  下面这个需要写 也就是 结尾 需要相对当前单元格 往右移动一格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 也就是说 这个图片会覆盖当前单元格和 后面的那一格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeLastColumnIndex(1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 写入数据</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            EasyExcel.write(fileName, ImageDemoData.class).sheet().doWrite(list);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="超链接备注公式指定单个单元格的样式单个单元格多种样式">超链接、备注、公式、指定单个单元格的样式、单个单元格多种样式<a class="hash-link" href="#超链接备注公式指定单个单元格的样式单个单元格多种样式" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-7">excel示例<a class="hash-link" href="#excel示例-7" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2021/png/553000/1632399587137-5177a60c-8b76-4611-be5c-1aa48705e23d.png#clientId=u3934b511-aee8-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=210&amp;id=u7c5a97bc&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=210&amp;originWidth=614&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=80843&amp;status=done&amp;style=none&amp;taskId=uc355f071-b03e-4dfd-a3d1-030924922fe&amp;title=&amp;width=614" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-7">对象<a class="hash-link" href="#对象-7" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class WriteCellDemoData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 超链接</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; hyperlink;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 备注</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; commentData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 公式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; formulaData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 指定单元格的样式。当然样式 也可以用注解等方式。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; writeCellStyle;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 指定一个单元格有多个样式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; richText;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-7">代码<a class="hash-link" href="#代码-7" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 超链接、备注、公式、指定单个单元格的样式、单个单元格多种样式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link WriteCellDemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void writeCellDataWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;writeCellDataWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellDemoData writeCellDemoData = new WriteCellDemoData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 设置超链接</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; hyperlink = new WriteCellData&lt;&gt;(&quot;官方网站&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setHyperlink(hyperlink);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        HyperlinkData hyperlinkData = new HyperlinkData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        hyperlink.setHyperlinkData(hyperlinkData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        hyperlinkData.setAddress(&quot;https://github.com/alibaba/easyexcel&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        hyperlinkData.setHyperlinkType(HyperlinkType.URL);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 设置备注</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; comment = new WriteCellData&lt;&gt;(&quot;备注的单元格信息&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setCommentData(comment);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        CommentData commentData = new CommentData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        comment.setCommentData(commentData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setAuthor(&quot;Jiaju Zhuang&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setRichTextStringData(new RichTextStringData(&quot;这是一个备注&quot;));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 备注的默认大小是按照单元格的大小 这里想调整到4个单元格那么大 所以向后 向下 各额外占用了一个单元格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setRelativeLastColumnIndex(1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setRelativeLastRowIndex(1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 设置公式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; formula = new WriteCellData&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setFormulaData(formula);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FormulaData formulaData = new FormulaData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        formula.setFormulaData(formulaData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 将 123456789 中的第一个数字替换成 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里只是例子 如果真的涉及到公式 能内存算好尽量内存算好 公式能不用尽量不用</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        formulaData.setFormulaValue(&quot;REPLACE(123456789,1,1,2)&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 设置单个单元格的样式 当然样式 很多的话 也可以用注解等方式。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; writeCellStyle = new WriteCellData&lt;&gt;(&quot;单元格样式&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyle.setType(CellDataTypeEnum.STRING);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setWriteCellStyle(writeCellStyle);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellStyle writeCellStyleData = new WriteCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyle.setWriteCellStyle(writeCellStyleData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里需要指定 FillPatternType 为FillPatternType.SOLID_FOREGROUND 不然无法显示背景颜色.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyleData.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 背景绿色</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyleData.setFillForegroundColor(IndexedColors.GREEN.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 设置单个单元格多种样式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; richTest = new WriteCellData&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTest.setType(CellDataTypeEnum.RICH_TEXT_STRING);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setRichText(richTest);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        RichTextStringData richTextStringData = new RichTextStringData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTest.setRichTextStringDataValue(richTextStringData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTextStringData.setTextString(&quot;红色绿色默认&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 前2个字红色</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteFont writeFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeFont.setColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTextStringData.applyFont(0, 2, writeFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 接下来2个字绿色</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeFont.setColor(IndexedColors.GREEN.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTextStringData.applyFont(2, 4, writeFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;WriteCellDemoData&gt; data = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        data.add(writeCellDemoData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, WriteCellDemoData.class).inMemory(true).sheet(&quot;模板&quot;).doWrite(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="根据模板写入">根据模板写入<a class="hash-link" href="#根据模板写入" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="模板excel示例">模板excel示例<a class="hash-link" href="#模板excel示例" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454122686-9d2057e0-7063-4e2d-b6ae-5effb7464144.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=229&amp;id=OYUkZ&amp;originHeight=229&amp;originWidth=332&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=332" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-8">excel示例<a class="hash-link" href="#excel示例-8" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454129904-8955f8f4-22a4-4b7d-9a30-057c3f308305.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=478&amp;id=ohNYU&amp;originHeight=478&amp;originWidth=344&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=344" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-8">对象<a class="hash-link" href="#对象-8" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-8">代码<a class="hash-link" href="#代码-8" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 根据模板写入</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link IndexData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. 使用{@link ExcelProperty}注解指定写入的列</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. 使用withTemplate 写取模板</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;4. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void templateWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String templateFileName = TestFileUtil.getPath() + &quot;demo&quot; + File.separator + &quot;demo.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;templateWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).withTemplate(templateFileName).sheet().doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="列宽行高">列宽、行高<a class="hash-link" href="#列宽行高" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-9">excel示例<a class="hash-link" href="#excel示例-9" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454147594-9473d4f6-f068-4f83-b403-474ef51f3cad.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=208&amp;id=VLodr&amp;originHeight=208&amp;originWidth=854&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=854" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-9">对象<a class="hash-link" href="#对象-9" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentRowHeight(10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadRowHeight(20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ColumnWidth(25)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class WidthAndHeightData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;字符串标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 宽度为50</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ColumnWidth(50)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-9">代码<a class="hash-link" href="#代码-9" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 列宽、行高</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link WidthAndHeightData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. 使用注解{@link ColumnWidth}、{@link HeadRowHeight}、{@link ContentRowHeight}指定宽度或高度</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void widthAndHeightWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;widthAndHeightWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, WidthAndHeightData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="注解形式自定义样式">注解形式自定义样式<a class="hash-link" href="#注解形式自定义样式" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="since">since<a class="hash-link" href="#since" title="标题的直接链接">​</a></h5><p>2.2.0-beta1</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-10">excel示例<a class="hash-link" href="#excel示例-10" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584459931145-96d4f61c-5a64-4dd0-b174-157e58c680bb.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=824&amp;id=YRC2m&amp;name=image.png&amp;originHeight=824&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=39533&amp;status=done&amp;style=none&amp;title=&amp;width=269" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-10">对象<a class="hash-link" href="#对象-10" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 头背景设置成红色 IndexedColors.RED.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 头字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 内容的背景设置成绿色 IndexedColors.GREEN.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 17)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 内容字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoStyleData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的头背景设置成粉红 IndexedColors.PINK.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 14)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的头字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的内容的背景设置成天蓝 IndexedColors.SKY_BLUE.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的内容字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;字符串标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * 样式的数据类</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 头背景设置成红色 IndexedColors.RED.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 头字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 内容的背景设置成绿色 IndexedColors.GREEN.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 17)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 内容字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoStyleData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的头背景设置成粉红 IndexedColors.PINK.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 14)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的头字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的内容的背景设置成天蓝 IndexedColors.SKY_BLUE.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 40)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 字符串的内容字体设置成20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;字符串标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-10">代码<a class="hash-link" href="#代码-10" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 注解形式自定义样式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoStyleData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.2.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void annotationStyleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;annotationStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoStyleData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="自定义样式">自定义样式<a class="hash-link" href="#自定义样式" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-11">excel示例<a class="hash-link" href="#excel示例-11" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454162913-76aed75e-9b02-4b7d-88a0-05c336133f8b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=497&amp;id=QZECN&amp;originHeight=497&amp;originWidth=270&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=270" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-11">对象<a class="hash-link" href="#对象-11" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-11">代码<a class="hash-link" href="#代码-11" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 拦截器形式自定义样式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 创建一个style策略 并注册</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void handlerStyleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法1 使用已有的策略 推荐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // HorizontalCellStyleStrategy 每一行的样式都一样 或者隔行一样</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // AbstractVerticalCellStyleStrategy 每一列的样式都一样 需要自己回调每一页</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;handlerStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 头的策略</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellStyle headWriteCellStyle = new WriteCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 背景设置为红色</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        headWriteCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteFont headWriteFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        headWriteFont.setFontHeightInPoints((short)20);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        headWriteCellStyle.setWriteFont(headWriteFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 内容的策略</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellStyle contentWriteCellStyle = new WriteCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里需要指定 FillPatternType 为FillPatternType.SOLID_FOREGROUND 不然无法显示背景颜色.头默认了 FillPatternType所以可以不指定</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 背景绿色</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteCellStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteFont contentWriteFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 字体大小</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteFont.setFontHeightInPoints((short)20);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteCellStyle.setWriteFont(contentWriteFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这个策略是 头是头的样式 内容是内容的样式 其他的策略可以自己实现</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        HorizontalCellStyleStrategy horizontalCellStyleStrategy =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(horizontalCellStyleStrategy)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法2: 使用easyexcel的方式完全自己写 不太推荐 尽量使用已有策略</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // @since 3.0.0-beta2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;handlerStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new CellWriteHandler() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                public void afterCellDispose(CellWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // 当前事件会在 数据设置到poi的cell里面才会回调</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // 判断不是头的情况 如果是fill 的情况 这里会==null 所以用not true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    if (BooleanUtils.isNotTrue(context.getHead())) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 第一个单元格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 只要不是头 一定会有数据 当然fill的情况 可能要context.getCellDataList() ,这个需要看模板，因为一个单元格会有多个 WriteCellData</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        WriteCellData&lt;?&gt; cellData = context.getFirstCellData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 这里需要去cellData 获取样式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 很重要的一个原因是 WriteCellStyle 和 dataFormatData绑定的 简单的说 比如你加了 DateTimeFormat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // ，已经将writeCellStyle里面的dataFormatData 改了 如果你自己new了一个WriteCellStyle，可能注解的样式就失效了</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 然后 getOrCreateStyle 用于返回一个样式，如果为空，则创建一个后返回</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        WriteCellStyle writeCellStyle = cellData.getOrCreateStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        writeCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 这里需要指定 FillPatternType 为FillPatternType.SOLID_FOREGROUND</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        writeCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 这样样式就设置好了 后面有个FillStyleCellWriteHandler 默认会将 WriteCellStyle 设置到 cell里面去 所以可以不用管了</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }).sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法3: 使用poi的样式完全自己写 不推荐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // @since 3.0.0-beta2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 坑1：style里面有dataformat 用来格式化数据的 所以自己设置可能导致格式化注解不生效</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 坑2：不要一直去创建style 记得缓存起来 最多创建6W个就挂了</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;handlerStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new CellWriteHandler() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                public void afterCellDispose(CellWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // 当前事件会在 数据设置到poi的cell里面才会回调</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // 判断不是头的情况 如果是fill 的情况 这里会==null 所以用not true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    if (BooleanUtils.isNotTrue(context.getHead())) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        Cell cell = context.getCell();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 拿到poi的workbook</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        Workbook workbook = context.getWriteWorkbookHolder().getWorkbook();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 这里千万记住 想办法能复用的地方把他缓存起来 一个表格最多创建6W个样式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 不同单元格尽量传同一个 cellStyle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        CellStyle cellStyle = workbook.createCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        cellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 这里需要指定 FillPatternType 为FillPatternType.SOLID_FOREGROUND</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        cell.setCellStyle(cellStyle);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 由于这里没有指定dataformat 最后展示的数据 格式可能会不太正确</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // 这里要把 WriteCellData的样式清空， 不然后面还有一个拦截器 FillStyleCellWriteHandler 默认会将 WriteCellStyle 设置到</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // cell里面去 会导致自己设置的不一样</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        context.getFirstCellData().setWriteCellStyle(null);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }).sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="合并单元格">合并单元格<a class="hash-link" href="#合并单元格" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="since-1">since<a class="hash-link" href="#since-1" title="标题的直接链接">​</a></h5><p>2.2.0-beta1</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-12">excel示例<a class="hash-link" href="#excel示例-12" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454178739-0ad9c4c9-f473-44db-8436-64d8265c88c4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=272&amp;id=uvyR7&amp;originHeight=272&amp;originWidth=291&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=291" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-12">对象<a class="hash-link" href="#对象-12" title="标题的直接链接">​</a></h5><p>方法1</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 将第6-7行的2-3列合并成一个单元格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// @OnceAbsoluteMerge(firstRowIndex = 5, lastRowIndex = 6, firstColumnIndex = 1, lastColumnIndex = 2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoMergeData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 这一列 每隔2行 合并单元格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentLoopMerge(eachRow = 2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;字符串标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>方法2参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-12">代码<a class="hash-link" href="#代码-12" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 合并单元格</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoData} {@link DemoMergeData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 创建一个merge策略 并注册</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.2.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void mergeWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法1 注解</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;mergeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 在DemoStyleData里面加上ContentLoopMerge注解</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoMergeData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 方法2 自定义合并单元格策略</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;mergeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 每隔2行会合并 把eachColumn 设置成 3 也就是我们数据的长度，所以就第一列会合并。当然其他合并策略也可以自己写</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        LoopMergeStrategy loopMergeStrategy = new LoopMergeStrategy(2, 0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).registerWriteHandler(loopMergeStrategy).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="使用table去写入">使用table去写入<a class="hash-link" href="#使用table去写入" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-13">excel示例<a class="hash-link" href="#excel示例-13" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454202085-e802591b-6e35-4848-b28b-8ebd72e357c6.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=496&amp;id=FW1a7&amp;originHeight=496&amp;originWidth=291&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=291" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-13">对象<a class="hash-link" href="#对象-13" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-13">代码<a class="hash-link" href="#代码-13" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 使用table去写入</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. 创建excel对应的实体对象 参照{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. 然后写入table即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void tableWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;tableWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里直接写多个table的案例了，如果只有一个 也可以直一行代码搞定，参照其他案例</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ExcelWriter excelWriter = null;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 把sheet设置为不需要头 不然会输出sheet的头 这样看起来第一个table 就有2个头了</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteSheet writeSheet = EasyExcel.writerSheet(&quot;模板&quot;).needHead(Boolean.FALSE).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里必须指定需要头，table 会继承sheet的配置，sheet配置了不需要，table 默认也是不需要</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteTable writeTable0 = EasyExcel.writerTable(0).needHead(Boolean.TRUE).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteTable writeTable1 = EasyExcel.writerTable(1).needHead(Boolean.TRUE).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 第一次写入会创建头</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter.write(data(), writeSheet, writeTable0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 第二次写如也会创建头，然后在第一次的后面写入数据</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter.write(data(), writeSheet, writeTable1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 千万别忘记finish 会帮忙关闭流</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="动态头实时生成头写入">动态头，实时生成头写入<a class="hash-link" href="#动态头实时生成头写入" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-14">excel示例<a class="hash-link" href="#excel示例-14" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454219952-d6ffd08d-71fc-4336-83ac-6cd468938ee5.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=334&amp;id=j5tp5&amp;originHeight=334&amp;originWidth=288&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=288" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-14">对象<a class="hash-link" href="#对象-14" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-14">代码<a class="hash-link" href="#代码-14" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 动态头，实时生成头写入</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 思路是这样子的，先创建List&lt;String&gt;头格式的sheet仅仅写入头,然后通过table 不写入头的方式 去写入数据</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 然后写入table即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void dynamicHeadWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;dynamicHeadWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里放入动态头</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .head(head()).sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 当然这里数据也可以用 List&lt;List&lt;String&gt;&gt; 去传入</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;String&gt;&gt; head() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = new ArrayList&lt;List&lt;String&gt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;字符串&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;数字&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;日期&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="自动列宽不太精确">自动列宽(不太精确)<a class="hash-link" href="#自动列宽不太精确" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-15">excel示例<a class="hash-link" href="#excel示例-15" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454254679-c2dc3148-2c31-4849-9d4d-0fc9a5791ad0.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=274&amp;id=lC4lH&amp;originHeight=274&amp;originWidth=1154&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=1154" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-15">对象<a class="hash-link" href="#对象-15" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class LongestMatchColumnWidthData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;字符串标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题很长日期标题很长日期标题很长很长&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;数字&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-15">代码<a class="hash-link" href="#代码-15" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 自动列宽(不太精确)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 这个目前不是很好用，比如有数字就会导致换行。而且长度也不是刚好和实际长度一致。 所以需要精确到刚好列宽的慎用。 当然也可以自己参照</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@link LongestMatchColumnWidthStyleStrategy}重新实现.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * poi 自带{@link SXSSFSheet#autoSizeColumn(int)} 对中文支持也不太好。目前没找到很好的算法。 有的话可以推荐下。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link LongestMatchColumnWidthData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 注册策略{@link LongestMatchColumnWidthStyleStrategy}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void longestMatchColumnWidthWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            TestFileUtil.getPath() + &quot;longestMatchColumnWidthWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, LongestMatchColumnWidthData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new LongestMatchColumnWidthStyleStrategy()).sheet(&quot;模板&quot;).doWrite(dataLong());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;LongestMatchColumnWidthData&gt; dataLong() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;LongestMatchColumnWidthData&gt; list = new ArrayList&lt;LongestMatchColumnWidthData&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            LongestMatchColumnWidthData data = new LongestMatchColumnWidthData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setString(&quot;测试很长的字符串测试很长的字符串测试很长的字符串&quot; + i);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDate(new Date());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDoubleData(1000000000000.0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="自定义拦截器上面几点都不符合但是要对单元格进行操作的参照这个">自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）<a class="hash-link" href="#自定义拦截器上面几点都不符合但是要对单元格进行操作的参照这个" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-16">excel示例<a class="hash-link" href="#excel示例-16" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454252320-bdd06be9-8f58-47fa-915f-c64f07765837.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=259&amp;id=R2VQ7&amp;originHeight=259&amp;originWidth=259&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=259" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-16">对象<a class="hash-link" href="#对象-16" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="定义拦截器">定义拦截器<a class="hash-link" href="#定义拦截器" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * 自定义拦截器。对第一行第一列的头超链接到:https://github.com/alibaba/easyexcel</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class CustomCellWriteHandler implements CellWriteHandler {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void afterCellDispose(CellWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Cell cell = context.getCell();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里可以对cell进行任何操作</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log.info(&quot;第{}行，第{}列写入完成。&quot;, cell.getRowIndex(), cell.getColumnIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (BooleanUtils.isTrue(context.getHead()) &amp;&amp; cell.getColumnIndex() == 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            CreationHelper createHelper = context.getWriteSheetHolder().getSheet().getWorkbook().getCreationHelper();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Hyperlink hyperlink = createHelper.createHyperlink(HyperlinkType.URL);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            hyperlink.setAddress(&quot;https://github.com/alibaba/easyexcel&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            cell.setHyperlink(hyperlink);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * 自定义拦截器.对第一列第一行和第二行的数据新增下拉框，显示 测试1 测试2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class CustomSheetWriteHandler implements SheetWriteHandler {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void afterSheetCreate(SheetWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log.info(&quot;第{}个Sheet写入成功。&quot;, context.getWriteSheetHolder().getSheetNo());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 区间设置 第一列第一行和第二行的数据。由于第一行是头，所以第一、二行的数据实际上是第二三行</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        CellRangeAddressList cellRangeAddressList = new CellRangeAddressList(1, 2, 0, 0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DataValidationHelper helper = context.getWriteSheetHolder().getSheet().getDataValidationHelper();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DataValidationConstraint constraint = helper.createExplicitListConstraint(new String[] {&quot;测试1&quot;, &quot;测试2&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DataValidation dataValidation = helper.createValidation(constraint, cellRangeAddressList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        context.getWriteSheetHolder().getSheet().addValidationData(dataValidation);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-16">代码<a class="hash-link" href="#代码-16" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 下拉，超链接等自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * demo这里实现2点。1. 对第一行第一列的头超链接到:https://github.com/alibaba/easyexcel 2. 对第一列第一行和第二行的数据新增下拉框，显示 测试1 测试2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 注册拦截器 {@link CustomCellWriteHandler} {@link CustomSheetWriteHandler}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void customHandlerWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;customHandlerWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).registerWriteHandler(new CustomSheetWriteHandler())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new CustomCellWriteHandler()).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="插入批注">插入批注<a class="hash-link" href="#插入批注" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-17">excel示例<a class="hash-link" href="#excel示例-17" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584962388694-b97f68aa-e1b0-4b64-9442-184ad9f97329.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=301&amp;id=r5pMZ&amp;name=image.png&amp;originHeight=301&amp;originWidth=287&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=18159&amp;status=done&amp;style=none&amp;title=&amp;width=287" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-17">对象<a class="hash-link" href="#对象-17" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="定义拦截器-1">定义拦截器<a class="hash-link" href="#定义拦截器-1" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * 自定义拦截器.新增注释,第一行头加批注</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class CommentWriteHandler implements RowWriteHandler {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void afterRowDispose(RowWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (BooleanUtils.isTrue(context.getHead())) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Sheet sheet = context.getWriteSheetHolder().getSheet();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Drawing&lt;?&gt; drawingPatriarch = sheet.createDrawingPatriarch();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 在第一行 第二列创建一个批注</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Comment comment =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                drawingPatriarch.createCellComment(new XSSFClientAnchor(0, 0, 0, 0, (short)1, 0, (short)2, 1));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 输入批注信息</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            comment.setString(new XSSFRichTextString(&quot;创建批注!&quot;));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 将批注添加到单元格对象中</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            sheet.getRow(0).getCell(1).setCellComment(comment);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-17">代码<a class="hash-link" href="#代码-17" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 插入批注</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 注册拦截器 {@link CommentWriteHandler}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void commentWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;commentWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里要注意inMemory 要设置为true，才能支持批注。目前没有好的办法解决 不在内存处理批注。这个需要自己选择。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).inMemory(Boolean.TRUE).registerWriteHandler(new CommentWriteHandler())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="可变标题处理包括标题国际化等">可变标题处理(包括标题国际化等)<a class="hash-link" href="#可变标题处理包括标题国际化等" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-18">excel示例<a class="hash-link" href="#excel示例-18" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454289882-fd4a4ba9-a800-4a34-bd66-92061d58c21b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=lFwAZ&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-18">对象<a class="hash-link" href="#对象-18" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ConverterData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想所有的 字符串起前面加上&quot;自定义：&quot;三个字</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;字符串标题&quot;, converter = CustomStringStringConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想写到excel 用年月日的格式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @DateTimeFormat(&quot;yyyy年MM月dd日HH时mm分ss秒&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想写到excel 用百分比表示</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @NumberFormat(&quot;#.##%&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ConverterData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想所有的 字符串起前面加上&quot;自定义：&quot;三个字</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;字符串标题&quot;, converter = CustomStringStringConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想写到excel 用年月日的格式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @DateTimeFormat(&quot;yyyy年MM月dd日HH时mm分ss秒&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;日期标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 我想写到excel 用百分比表示</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @NumberFormat(&quot;#.##%&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;数字标题&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-18">代码<a class="hash-link" href="#代码-18" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 可变标题处理(包括标题国际化等)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 简单的说用List&lt;List&lt;String&gt;&gt;的标题 但是还支持注解</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link ConverterData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 直接写即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void variableTitleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 写法1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;variableTitleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, ConverterData.class).head(variableTitleHead()).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;String&gt;&gt; variableTitleHead() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;string&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;number&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;date&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }    private List&lt;List&lt;String&gt;&gt; variableTitleHead() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;string&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;number&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;date&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2></h2><h2 class="anchor anchorWithStickyNavbar_mojV" id="不创建对象的写">不创建对象的写<a class="hash-link" href="#不创建对象的写" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excel示例-19">excel示例<a class="hash-link" href="#excel示例-19" title="标题的直接链接">​</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454289882-fd4a4ba9-a800-4a34-bd66-92061d58c21b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=W4eqU&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-19">代码<a class="hash-link" href="#代码-19" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 不创建对象的写</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void noModelWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 写法1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;noModelWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName).head(head()).sheet(&quot;模板&quot;).doWrite(dataList());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;String&gt;&gt; head() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;字符串&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;数字&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;日期&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;Object&gt;&gt; dataList() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;Object&gt;&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            List&lt;Object&gt; data = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.add(&quot;字符串&quot; + i);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.add(new Date());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.add(0.56);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="web中的写">web中的写<a class="hash-link" href="#web中的写" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="示例代码-1">示例代码<a class="hash-link" href="#示例代码-1" title="标题的直接链接">​</a></h5><p>DEMO代码地址：<a href="https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-19">对象<a class="hash-link" href="#对象-19" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a> 就是名称变了下</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-20">代码<a class="hash-link" href="#代码-20" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 文件下载（失败了会返回一个有部分数据的Excel）</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. 创建excel对应的实体对象 参照{@link DownloadData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. 设置返回的 参数</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. 直接写，这里注意，finish的时候会自动关闭OutputStream,当然你外面再关闭流问题不大</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @GetMapping(&quot;download&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void download(HttpServletResponse response) throws IOException {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response.setCharacterEncoding(&quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = URLEncoder.encode(&quot;测试&quot;, &quot;UTF-8&quot;).replaceAll(&quot;\\+&quot;, &quot;%20&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#x27;&#x27;&quot; + fileName + &quot;.xlsx&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(response.getOutputStream(), DownloadData.class).sheet(&quot;模板&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="web中的写并且失败的时候返回json">web中的写并且失败的时候返回json<a class="hash-link" href="#web中的写并且失败的时候返回json" title="标题的直接链接">​</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="since-2">since<a class="hash-link" href="#since-2" title="标题的直接链接">​</a></h5><p>2.1.1</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="对象-20">对象<a class="hash-link" href="#对象-20" title="标题的直接链接">​</a></h5><p>参照：<a href="#5bd247f4">对象</a> 就是名称变了下</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="代码-21">代码<a class="hash-link" href="#代码-21" title="标题的直接链接">​</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 文件下载并且失败的时候返回json（默认失败了会返回一个有部分数据的Excel）</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @GetMapping(&quot;downloadFailedUsingJson&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void downloadFailedUsingJson(HttpServletResponse response) throws IOException {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setCharacterEncoding(&quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            String fileName = URLEncoder.encode(&quot;测试&quot;, &quot;UTF-8&quot;).replaceAll(&quot;\\+&quot;, &quot;%20&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#x27;&#x27;&quot; + fileName + &quot;.xlsx&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 这里需要设置不关闭流</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            EasyExcel.write(response.getOutputStream(), DownloadData.class).autoCloseStream(Boolean.FALSE).sheet(&quot;模板&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 重置response</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.reset();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setContentType(&quot;application/json&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setCharacterEncoding(&quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Map&lt;String, String&gt; map = MapUtils.newHashMap();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            map.put(&quot;status&quot;, &quot;failure&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            map.put(&quot;message&quot;, &quot;下载文件失败&quot; + e.getMessage());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.getWriter().println(JSON.toJSONString(map));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/quickstart/write.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/3.x/quickstart/read"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">读Excel</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/3.x/quickstart/fil"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">填充Excel</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#示例代码" class="table-of-contents__link toc-highlight">示例代码</a></li><li><a href="#最简单的写" class="table-of-contents__link toc-highlight">最简单的写</a></li><li><a href="#根据参数只导出指定列" class="table-of-contents__link toc-highlight">根据参数只导出指定列</a></li><li><a href="#指定写入的列" class="table-of-contents__link toc-highlight">指定写入的列</a></li><li><a href="#复杂头写入" class="table-of-contents__link toc-highlight">复杂头写入</a></li><li><a href="#重复多次写入写到单个或者多个sheet" class="table-of-contents__link toc-highlight">重复多次写入(写到单个或者多个Sheet)</a></li><li><a href="#日期数字或者自定义格式转换" class="table-of-contents__link toc-highlight">日期、数字或者自定义格式转换</a></li><li><a href="#图片导出" class="table-of-contents__link toc-highlight">图片导出</a></li><li><a href="#超链接备注公式指定单个单元格的样式单个单元格多种样式" class="table-of-contents__link toc-highlight">超链接、备注、公式、指定单个单元格的样式、单个单元格多种样式</a></li><li><a href="#根据模板写入" class="table-of-contents__link toc-highlight">根据模板写入</a></li><li><a href="#列宽行高" class="table-of-contents__link toc-highlight">列宽、行高</a></li><li><a href="#注解形式自定义样式" class="table-of-contents__link toc-highlight">注解形式自定义样式</a></li><li><a href="#自定义样式" class="table-of-contents__link toc-highlight">自定义样式</a></li><li><a href="#合并单元格" class="table-of-contents__link toc-highlight">合并单元格</a></li><li><a href="#使用table去写入" class="table-of-contents__link toc-highlight">使用table去写入</a></li><li><a href="#动态头实时生成头写入" class="table-of-contents__link toc-highlight">动态头，实时生成头写入</a></li><li><a href="#自动列宽不太精确" class="table-of-contents__link toc-highlight">自动列宽(不太精确)</a></li><li><a href="#自定义拦截器上面几点都不符合但是要对单元格进行操作的参照这个" class="table-of-contents__link toc-highlight">自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）</a></li><li><a href="#插入批注" class="table-of-contents__link toc-highlight">插入批注</a></li><li><a href="#可变标题处理包括标题国际化等" class="table-of-contents__link toc-highlight">可变标题处理(包括标题国际化等)</a></li><li><a href="#不创建对象的写" class="table-of-contents__link toc-highlight">不创建对象的写</a></li><li><a href="#web中的写" class="table-of-contents__link toc-highlight">web中的写</a></li><li><a href="#web中的写并且失败的时候返回json" class="table-of-contents__link toc-highlight">web中的写并且失败的时候返回json</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/3.x/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/3.x/">Second Doc</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_gHmE"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></a></div><div class="footer__copyright">Copyright © 2022 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9214ad1a.js"></script>
<script src="/assets/js/main.834bc3ec.js"></script>
</body>
</html>